#include <stdio.h>

int rows = 3, cols = 3;
int grid[3][3] = {0};

void updateStatus()
{
    int r, c, flag, value;
    printf("\nEnter sector row and column (0-%d, 0-%d): ", rows-1, cols-1);
    scanf("%d %d", &r, &c);
    if(r>=rows || c>=cols || r<0 || c<0)
    {
        printf("Invalid sector\n");
        return;
    }
    printf("Enter flag to update (0=Power,1=Overload,2=Maintenance): ");
    scanf("%d", &flag);
    printf("Enter value (0=clear,1=set): ");
    scanf("%d", &value);

    if(value == 1)
        grid[r][c] = grid[r][c] | (1 << flag);
    else
        grid[r][c] = grid[r][c] & (~(1 << flag));

    printf("Sector updated\n");
}

void queryStatus()
{
    int r, c;
    printf("\nEnter sector row and column: ");
    scanf("%d %d", &r, &c);
    if(r>=rows || c>=cols || r<0 || c<0)
    {
        printf("Invalid sector\n");
        return;
    }
    int val = grid[r][c];
    printf("\nSector (%d,%d) Status:\n", r, c);
    printf("Power: %s\n", (val & 1) ? "ON" : "OFF");
    printf("Overload: %s\n", (val & 2) ? "Yes" : "No");
    printf("Maintenance: %s\n", (val & 4) ? "Required" : "Not required");
}

void runDiagnostic()
{
    int overload = 0, maintenance = 0;
    for(int i=0; i<rows; i++)
    {
        for(int j=0; j<cols; j++)
        {
            if(grid[i][j] & 2) overload++;
            if(grid[i][j] & 4) maintenance++;
        }
    }
    printf("\nTotal sectors overloaded: %d\n", overload);
    printf("Total sectors requiring maintenance: %d\n", maintenance);
}

int main()
{
    int opt;
    while(1)
    {
        printf("\n--- Power Grid Menu ---\n");
        printf("1. Update Sector Status\n2. Query Sector Status\n3. Run System Diagnostic\n4. Exit\n");
        printf("Enter choice: ");
        scanf("%d", &opt);
        switch(opt)
        {
            case 1: updateStatus(); break;
            case 2: queryStatus(); break;
            case 3: runDiagnostic(); break;
            case 4: return 0;
            default: printf("Invalid choice\n");
        }
    }
}
